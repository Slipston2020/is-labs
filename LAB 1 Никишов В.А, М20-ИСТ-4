PREDICATES
%фигура(код фигуры, цвет, координата X, координата Y)
nondeterm фигура(symbol, symbol, integer, symbol)
%ходящая_пешка(код ходящей пешки, цвет, координата X, координата Y)
nondeterm ходящая_пешка(symbol, symbol, integer, symbol)
%номер_буквы(номер, буква)
nondeterm номер_буквы(integer, symbol)
%результат (код ходящей пешки, цвет, новая координата X, новая координата по Y, код взятой фигуры)
nondeterm результат(symbol, symbol, integer, symbol, symbol)

CLAUSES
%фигуры на доске
фигура(кор1, черный, 8, e). %факт 1
фигура(фер1, черный, 7, d). %факт 2
фигура(кон1, черный, 6, f). %факт 3
фигура(лад1, черный, 3, g). %факт 4
фигура(слон1, черный, 5, c). %факт 5
фигура(кон2, черный, 5, e). %факт 6
фигура(кор1, белый, 1, e). %факт 7
фигура(кон1, белый, 1, b). %факт 8
фигура(лад1, белый, 1, f). %факт 9
фигура(слон1, белый, 7, h). %факт 10

%та самая пешка, которая должна ходить
ходящая_пешка(пеш1, белый, 4, d). %факт 11

%проводить арифметические операции с буквами мы не можем, поэтому вводим новый предикат, который каждой букве ставит в соответствии число (для удобства берем числа от 1 до 8).
номер_буквы(1, a). %факт 12
номер_буквы(2, b). %факт 13
номер_буквы(3, c). %факт 14
номер_буквы(4, d). %факт 15
номер_буквы(5, e). %факт 16
номер_буквы(6, f). %факт 17
номер_буквы(7, g). %факт 18
номер_буквы(8, h). %факт 19


%ЧАСТНЫЕ ПРАВИЛА

%результат(пеш1, белый, 5, c, слон1):- 	ходящая_пешка(пеш1, белый, 4, d), фигура (слон1, черный, 5, c). % частное правило 1
%пешка с кодом пеш1 белого цвета возьмет фигуру с кодом слон1 и встанет на место 5 c, если существует ходящая пешка с кодом пеш1 белого цвета и координатами 4 d
%и если существует фигура с кодом слон1 черного цвета с координатами 5 c

%результат(пеш1, белый, 5, e, кон2):- 	ходящая_пешка(пеш1, белый, 4, d), фигура (кон2, черный, 5, e). % частное правило 2
%пешка с кодом пеш1 белого цвета возьмет фигуру с кодом кон2 и встанет на место 5 e, если существует ходящая пешка с кодом пеш1 белого цвета и координатами 4 d
%и если существует фигура с кодом кон2 черного цвета с координатами 5 e



%УНИВЕРСАЛЬНЫЕ ПРАВИЛА

%здесь следует отметить, что для белых и черных пешек правила хода и взятия будут разные 
%белые пешки ходят ВПЕРЕД по шахматной доске, т.е. координату по X будем увеличивать на 1
%черные пешки ходят НАЗАД по щахматной доске, т.е. координату по Y будем уменьшать на 1
%в результате получаем 4 правила - 2 для белой пешки и 2 для черной пешки


%ДЛЯ БЕЛЫХ

%ходим вперед влево

%X и Y - новые координаты пешки, куда она должна сходить
%Текущая_координата_по_X и Текущая_координата_по_Y - координаты клетки, в которой пешка находится изначально

результат(Код_пешки, Цвет, X, Y, Код_взятой_фигуры):- 	
			ходящая_пешка(Код_пешки, Цвет, Текущая_координата_по_X, Текущая_координата_по_Y), % находим ходящую пешку, определяем у нее код, цвет и координаты X и Y
			Цвет = белый, %проверяем: цвет ходящей пешки белый?
			X = Текущая_координата_по_X + 1, % определяем новую координату по X: текущую координату увеличиваем на 1
			X <= 8, % чтобы не выйти на пределы игрового поля, вводим ограничение - новая координата X должна быть не больше 8
			номер_буквы(Текущий_номер_буквы, Текущая_координата_по_Y), 	% далее определяем новую координату по Y. 
						   					% для этого предикату номер_буквы передаем известное нам значение текущей координаты пешки по Y (Текущая_координата_по_Y)
						   					% и получаем номер буквы этой самой координаты (Текущий_номер_буквы)
			Номер_буквы = Текущий_номер_буквы - 1, 	% теперь мы можем работать с числами. рассчитываем номер буквы новой координаты по Y, в которую должна сходить пешка (Номер_буквы)
								% для этого из найденного на предыдущем шаге текущего номера буквы (Текущий_номер_буквы) вычитаем 1
			номер_буквы(Номер_буквы, Y), 	%для найденного нового номера буквы (Номер_буквы) на предыдущей шаге определяем соответствующее значение координаты Y
							% таким образом мы нашли координату по Y
			/* вводить ограничение (чтобы не выйти за пределы игрового поля) для Y не нужно, т.к. если в результате подсчета номера буквы мы получим Номер_буквы = 9 или Номер_буквы = 0, 
			передав эти значения в предикат номер_буквы, мы не найдем соответствующих букв для значений 9 и 0, соответветственно получим ложь и неправильный вариант хода будет отброшен */
			фигура(Код_взятой_фигуры, Цвет_фигуры, X, Y), % проверяем: есть ли на доске фигура с найденными нами новыми координатами X и Y. если да, то определяем у такой фигуры код и цвет
			Цвет_фигуры = черный. % проверяем: цветы фигуры черный? это важно, т.к. белые пешки могут есть только черные фигуры
			%правило 1


%ходим вперед вправо	

% аналогично правилу 1. единственная разница - номер буквы не уменьшаем, а уже увеличиваем на 1					   
результат(Код_пешки, Цвет, X, Y, Код_взятой_фигуры):- 	ходящая_пешка(Код_пешки, Цвет, Текущая_координата_по_X, Текущая_координата_по_Y), 
							Цвет = белый,
						  	X = Текущая_координата_по_X + 1, 
						  	X <= 8,
						  	номер_буквы(Текущий_номер_буквы, Текущая_координата_по_Y), 
						  	Номер_буквы = Текущий_номер_буквы + 1, 
						  	номер_буквы(Номер_буквы, Y),
						   	фигура(Код_взятой_фигуры, Цвет_фигуры, X, Y), 
						   	Цвет_фигуры = черный. %правило 2


%ДЛЯ ЧЕРНЫХ

%ходим назад налево						   
результат(Код_пешки, Цвет, X, Y, Код_взятой_фигуры):- 	ходящая_пешка(Код_пешки, Цвет, Текущая_координата_по_X, Текущая_координата_по_Y), 
							Цвет = черный,
						   	X = Текущая_координата_по_X - 1, 
						   	X >= 1,
						   	номер_буквы(Текущий_номер_буквы, Текущая_координата_по_Y), 
						   	Номер_буквы = Текущий_номер_буквы - 1, 
						   	номер_буквы(Номер_буквы, Y),
						   	фигура(Код_взятой_фигуры, Цвет_фигуры, X, Y), 
						   	Цвет_фигуры = белый. %правило 3

%ходим назад направо						   
результат(Код_пешки, Цвет, X, Y, Код_взятой_фигуры):- 	ходящая_пешка(Код_пешки, Цвет, Текущая_координата_по_X, Текущая_координата_по_Y), 
							Цвет = черный,
						   	X = Текущая_координата_по_X - 1, 
						   	X >= 1,
						   	номер_буквы(Текущий_номер_буквы, Текущая_координата_по_Y), 
						   	Номер_буквы = Текущий_номер_буквы + 1, 
						   	номер_буквы(Номер_буквы, Y),
						   	фигура(Код_взятой_фигуры, Цвет_фигуры, X, Y), 
						   	Цвет_фигуры = белый. %правило 4


GOAL
%фигура(фер1, черный, 7, d). %запрос 1
%Решение:	yes

%фигура(кор1, белый, X, Y). %запрос 2
%Решение:	X=1, Y=e

%ходящая_пешка(пеш1, белый, 4, d). %запрос 3
%Решение:	yes

%ходящая_пешка(пеш1, белый, X, Y). %запрос 4
%Решение:	X=4, Y=d

%номер_буквы(4, d). %запрос 5
%Решение:	yes

%номер_буквы(X, c). %запрос 6
%Решение:	X=3

%результат(пеш1, белый, 5, e, кон2). %запрос 7
%Решение:	yes

%результат(пеш1, белый, X, Y, Код_взятой_фигуры). %запрос 8
/* Решение: 	X=5, Y=c, Код_взятой_фигуры=слон1
		X=5, Y=e, Код_взятой_фигуры=кон2
		2 Solutions
*/

результат(Код_пешки, Цвет, X, Y, Код_взятой_фигуры). %запрос 9
/* Решение: 	Код_пешки=пеш1, Цвет=белый, X=5, Y=c, Код_взятой_фигуры=слон1
		Код_пешки=пеш1, Цвет=белый, X=5, Y=e, Код_взятой_фигуры=кон2
		2 Solutions
*/
						   
						   
